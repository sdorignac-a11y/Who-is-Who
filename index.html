<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Impostor F√∫tbol ‚Äì Men√∫</title>

  <!-- Fuentes -->
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Outfit:wght@400;600;800;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --sky-1:#0a1c33; --sky-2:#0f2b4f; --sky-3:#0a1f3b; --grass:#1f7b2e;
      --gold-1:#f5c63b; --gold-2:#c79416;
      --blue-1:#2b6fe4; --blue-2:#1448a6;
      --green-1:#2dbb4f; --green-2:#14823a;
      --dark-1:#2b2f36; --dark-2:#1b1f26;
      --text:#eef3ff; --shadow:#07101f; --glow:#79c7ff;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;color:var(--text);
      font-family:"Outfit",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial,sans-serif;
      display:flex;flex-direction:column;align-items:center;justify-content:flex-start;
      min-height:100vh; overflow-x:hidden; padding:48px 16px 32px;
      background:
        radial-gradient(120px 80px at 12% 14%, #ffffffa8 0%, #c3e4ff33 30%, #0000 70%),
        radial-gradient(140px 100px at 88% 18%, #ffffffa8 0%, #c3e4ff33 30%, #0000 70%),
        radial-gradient(120% 80% at 50% 0%, #0000 60%, #0a1527 61% 68%, #0000 69%),
        radial-gradient(120% 80% at 50% 6%, #0000 62%, #0b1a31 63% 70%, #0000 71%),
        radial-gradient(80% 50% at 50% 100%, #0b2d15 0%, #10461e 35%, #174e24 55%, #123a1b 70%, #0b2d15 100%),
        linear-gradient(180deg, var(--sky-1) 0%, var(--sky-2) 50%, var(--sky-3) 100%);
      background-repeat:no-repeat;background-size:cover;
    }

    .title{
      margin:0 0 28px; line-height:1; letter-spacing:1px; text-transform:uppercase;
      font-family:"Bebas Neue","Outfit",sans-serif; font-size:clamp(48px, 8vw, 120px);
      display:flex;gap:18px;align-items:flex-end;justify-content:center;flex-wrap:wrap;
      filter: drop-shadow(0 10px 24px #0006);
    }
    .title .light{
      background:linear-gradient(180deg,#ffffff,#d9e2f9 45%,#a6b3d6 60%,#ffffff 100%);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      text-shadow:0 1px 0 #fff8, 0 12px 24px #0006;
    }
    .title .gold{
      background:linear-gradient(180deg,#fff2b3 0%, var(--gold-1) 35%, var(--gold-2) 70%, #8d6312 100%);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      text-shadow:0 1px 0 #fff6, 0 8px 18px #0007;
      margin-left:12px;
    }
    .title .ball{ font-size:clamp(36px,6vw,72px); transform:translateY(-6px); filter: drop-shadow(0 6px 16px #0007); }

    .menu-btn{
      --c1: var(--blue-1); --c2: var(--blue-2); --outer:#0a1730;
      display:flex;align-items:center;justify-content:center;gap:14px;
      width:min(900px, 92vw); padding:22px 26px; margin:14px auto;
      font-weight:900; font-size:clamp(18px,2.4vw,32px); letter-spacing:.5px;
      color:#f7fbff; text-decoration:none; cursor:pointer;
      background:
        radial-gradient(120% 180% at 50% 0%, #ffffff22 0 20%, #0000 30%),
        linear-gradient(180deg, var(--c1), var(--c2));
      border-radius:16px; border:1px solid #ffffff22;
      box-shadow: 0 0 0 4px var(--outer), 0 12px 24px rgba(0,0,0,.35),
                  inset 0 1px 0 #ffffff80, inset 0 -4px 0 rgba(0,0,0,.25),
                  0 0 24px color-mix(in oklab, var(--c1), white 30%);
      transition:transform .15s ease, box-shadow .15s ease, filter .15s ease;
    }
    .menu-btn:hover{
      transform: translateY(-3px);
      box-shadow: 0 0 0 4px var(--outer), 0 18px 30px rgba(0,0,0,.45),
                  inset 0 1px 0 #ffffffaa, inset 0 -4px 0 rgba(0,0,0,.3),
                  0 0 36px color-mix(in oklab, var(--c1), white 40%);
      filter: saturate(1.08) brightness(1.03);
    }
    .menu-btn:active{ transform:translateY(0); }

    .yellow{ --c1: var(--gold-1); --c2: var(--gold-2); --outer:#3b2a05; color:#1a1305; text-shadow:0 1px 0 #fff6; }
    #link-offline{ --c1: var(--dark-1); --c2: var(--dark-2); --outer:#0b0e13; color:#e8edf7; }
    .caps{
      display:inline-block; padding:6px 12px; background:linear-gradient(180deg,#1f3e8a,#112a64);
      color:#e6f1ff; border:1px solid #ffffff33; border-radius:10px; font-size:.65em;
      box-shadow:inset 0 -3px 0 #0b1a3a, 0 3px 10px #0006; letter-spacing:.5px;
    }

    /* Modal perfil */
    .backdrop{position:fixed;inset:0;background:rgba(0,10,20,.55);backdrop-filter:blur(2px);display:none;place-items:center;z-index:60}
    .name-card{width:min(520px,92vw);background:#0b1220;color:#fff;border:1px solid rgba(255,255,255,.18);
      border-radius:18px;padding:20px 18px;box-shadow:0 40px 80px rgba(0,0,0,.55);font-family:"Outfit",sans-serif}
    .name-card h3{margin:0 0 8px;font-size:24px}
    .name-card p{margin:0 0 14px;opacity:.9}
    .name-row{display:flex;gap:10px}
    .name-input{flex:1;padding:14px 16px;border-radius:14px;border:1px solid rgba(255,255,255,.25);
      background:#0f172a;color:#fff;font-size:16px;outline:none}
    .name-input:focus{border-color:#38bdf8;box-shadow:0 0 0 3px #38bdf833}
    .name-btn{padding:12px 16px;border-radius:12px;border:1px solid rgba(255,255,255,.35);cursor:pointer;
      background:linear-gradient(180deg,#facc15,#eab308);color:#111;font-weight:900}
    .name-error{margin-top:8px;font-size:13px;color:#fb7185;min-height:18px}
    .avatar-grid{display:grid;grid-template-columns:repeat(6,56px);gap:10px;justify-content:center;margin-top:12px}
    .avatar-opt{width:56px;height:56px;border-radius:50%;overflow:hidden;cursor:pointer;border:2px solid transparent;background:#0f172a;display:grid;place-items:center}
    .avatar-opt img{width:100%;height:100%;object-fit:cover;display:block}
    .avatar-opt.selected{border-color:#facc15;box-shadow:0 0 0 3px rgba(250,204,21,.35)}
    .avatar-hint{margin:8px 0 0;font-size:13px;opacity:.85}

    /* Overlay loader */
    .overlay{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,10,20,.9);z-index:1000;padding:16px}
    .overlay.show{display:grid}
    .loader-card{
      width:min(520px,96vw);
      background:linear-gradient(180deg,#102c4f,#0c2441);
      border:1px solid rgba(128,180,255,.28); border-radius:16px;
      box-shadow:0 20px 60px rgba(0,0,0,.6);
      padding:18px; text-align:center; font-family:"Outfit",sans-serif;
    }
    .spinner{ width:58px; height:58px; border-radius:50%;
      border:4px solid rgba(255,255,255,.2); border-top-color:var(--gold-1);
      margin:10px auto 12px; animation:spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}
    .stage{font-weight:800; letter-spacing:.3px; margin:0 0 6px}
    .hint{opacity:.85; font-size:14px; margin:0 0 10px}
    .err{color:#ffd5d1; background:rgba(234,67,53,.12); border:1px solid rgba(234,67,53,.35); padding:8px 10px; border-radius:10px; display:none; margin:8px 0}
    .loader-actions{display:flex; gap:10px; justify-content:center; margin-top:10px}
    .btn.alt{background:linear-gradient(180deg,#183861,#0f2644)}
    .btn.red{background:linear-gradient(180deg,#ff6b6b,#ea4335); border-color:#ffb3ac}
    .sr-only{position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

    /* Tarjeta listado p√∫blico */
    #publicRoomsCard{ width:min(900px,92vw); margin-top:24px; text-align:left; }
    #publicRoomsList{ max-height:320px; overflow-y:auto; border-radius:14px; background:#0c1c32; padding:12px 14px; box-shadow:0 4px 16px rgba(0,0,0,.35); }
    .room-item{ background:#12274b; border-radius:10px; padding:10px 12px; margin-bottom:8px; display:flex; justify-content:space-between; align-items:center; }
    .join-btn{ --c1:var(--green-1); --c2:var(--green-2); --outer:#0a2b12; padding:8px 12px; font-size:14px; border-radius:10px; }
    /* ---- Modal salas al azar ---- */
.rz-backdrop{position:fixed;inset:0;background:rgba(0,10,20,.6);backdrop-filter:blur(2px);
  display:none;place-items:center;z-index:80;padding:16px}
.rz-backdrop.show{display:grid}
.rz-card{width:min(760px,96vw);background:#0b1220;color:#eaf2ff;border:1px solid rgba(128,180,255,.28);
  border-radius:16px;box-shadow:0 24px 80px rgba(0,0,0,.55);padding:16px}
.rz-list{max-height:420px;overflow:auto;background:#0c1d35;border:1px solid rgba(128,180,255,.2);
  border-radius:12px;padding:10px}
.rz-item{display:flex;justify-content:space-between;align-items:center;gap:10px;
  background:#112649;border:1px solid rgba(128,180,255,.25);border-radius:10px;padding:10px;margin:6px 0}
.rz-meta{font-weight:700}
.rz-sub{opacity:.85;font-size:12px}
.rz-btn{cursor:pointer;border:1px solid rgba(255,255,255,.3);border-radius:10px;
  padding:8px 12px;background:linear-gradient(180deg,#1e68d6,#184fa5);color:#fff;font-weight:800}
.rz-btn.success{background:linear-gradient(180deg,#22c55e,#16a34a);border-color:rgba(255,255,255,.25)}
.rz-btn.ghost{background:linear-gradient(180deg,#0f213b,#0a1a30)}
.rz-input{flex:1;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.25);
  background:#0a1f39;color:#eaf2ff}
.rz-tag{display:inline-block;padding:2px 6px;border-radius:8px;background:#0c2441;border:1px solid rgba(128,180,255,.25);
  font-size:12px;margin-left:6px}

  </style>
</head>
<body>
  <!-- T√≠tulo -->
  <h1 class="title">
    <span class="light">IMPOSTOR</span>
    <span class="gold">F√öTBOL</span>
    <span class="ball">‚öΩ</span>
  </h1>

  <!-- Botones -->
  <a id="link-crear" class="menu-btn yellow" href="crear.html">üèÜ CREAR SALA</a>
  <a id="link-offline" class="menu-btn" href="offline.html">‚õî Offline</a>
  <a id="link-ingresar" class="menu-btn" href="ingresar.html">üîë INGRESAR A SALA</a>
  <button id="btn-azar" class="menu-btn" style="--c1:var(--green-1);--c2:var(--green-2);--outer:#0a2b12;">
    üé≤ UNIRSE AL <span class="caps">AZAR</span>
  </button>

  <!-- ==== SALAS P√öBLICAS ==== -->
  <div id="publicRoomsCard">
    <h2 style="font-family:'Bebas Neue',sans-serif;font-size:32px;margin:0 0 8px;">üèüÔ∏è Salas p√∫blicas disponibles</h2>
    <p style="margin:0 0 10px;color:#a3b8da;font-size:15px;">Eleg√≠ una para unirte al instante:</p>
    <div id="publicRoomsList"></div>
  </div>

  <!-- ===== Perfil (nombre + avatar) ===== -->
  <script>
    const AVATARS = [
      {key:"maradona",   src:"avatars/maradona.png"},
      {key:"ronaldo",    src:"avatars/ronaldo.png"},
      {key:"cristiano",  src:"avatars/cristiano.png"},
      {key:"ronaldinho", src:"avatars/ronaldinho.png"},
      {key:"lamine",     src:"avatars/lamine.png"},
      {key:"odegar",     src:"avatars/odegar.png"}
    ];
    window.PlayerProfile = {
      getName(){ return localStorage.getItem("displayName") || ""; },
      setName(n){ localStorage.setItem("displayName", n); },
      getAvatar(){ return localStorage.getItem("avatarKey") || ""; },
      setAvatar(k){ localStorage.setItem("avatarKey", k); },
      async ensure(){
        const valid = s => typeof s==="string" && s.trim().length>=2 && s.trim().length<=16;
        let name = this.getName(), avatar = this.getAvatar();
        if (valid(name) && avatar) return {name, avatar};

        const modal = document.getElementById("name-modal");
        const input = document.getElementById("displayName");
        const btn   = document.getElementById("saveName");
        const errEl = document.getElementById("nameError");
        const grid  = document.getElementById("avatarGrid");
        const close = ()=>{ modal.style.display="none"; modal.setAttribute("aria-hidden","true"); };

        grid.innerHTML = "";
        AVATARS.forEach(a=>{
          const b = document.createElement("button");
          b.type = "button"; b.className = "avatar-opt";
          b.innerHTML = `<img src="${a.src}" alt="${a.key}" />`;
          if ((avatar||"") === a.key) b.classList.add("selected");
          b.addEventListener("click", ()=>{
            document.querySelectorAll(".avatar-opt").forEach(x=>x.classList.remove("selected"));
            b.classList.add("selected");
            avatar = a.key;
          });
          grid.appendChild(b);
        });

        modal.style.display="grid";
        modal.setAttribute("aria-hidden","false");
        input.value = this.getName() || ""; input.focus();

        return new Promise((resolve)=>{
          const save = ()=>{
            const v = (input.value||"").trim();
            if(!valid(v)){ errEl.textContent = "Us√° entre 2 y 16 caracteres."; return; }
            if(!avatar){ errEl.textContent = "Eleg√≠ un avatar."; return; }
            this.setName(v); this.setAvatar(avatar);
            errEl.textContent = ""; close(); resolve({name:v, avatar});
          };
          btn.onclick = save;
          input.onkeydown = (e)=>{ if(e.key==="Enter") save(); if(e.key==="Escape") close(); };
          modal.onclick = (e)=>{ if(e.target===modal){ input.focus(); } };
        });
      }
    };
  </script>

  <!-- ===== Firebase + acciones ===== -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged, setPersistence, browserLocalPersistence } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import {
      getFirestore, doc, setDoc, getDoc, collection, getDocs, writeBatch, serverTimestamp,
      query, where, onSnapshot, orderBy, limit
    } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    (async () => {
      try {
        const firebaseConfig = {
          apiKey: "AIzaSyAegeue7A8qFFW4IScFFgtvT4P1g2GLkCM",
          authDomain: "who-is-who-6ea99.firebaseapp.com",
          projectId: "who-is-who-6ea99",
          storageBucket: "who-is-who-6ea99.firebasestorage.app",
          messagingSenderId: "718537140049",
          appId: "1:718537140049:web:7400ec7e5467b387f8d570",
          measurementId: "G-KNC4FJXXBN"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        /* ---------- OVERLAY LOADER ---------- */
        const loader = document.createElement('div');
        loader.id = 'room-loader';
        loader.className = 'overlay';
        loader.innerHTML = `
          <div class="loader-card" role="dialog" aria-modal="true" aria-label="Creando sala">
            <div class="spinner" aria-hidden="true"></div>
            <p id="loaderStage" class="stage">Preparando‚Ä¶</p>
            <p id="loaderHint" class="hint">No cierres esta ventana.</p>
            <div id="loaderErr" class="err"></div>
            <div class="loader-actions">
              <button id="retryBtn" class="menu-btn alt" style="--c1:#183861;--c2:#0f2644;--outer:#0a1730;display:none">Reintentar</button>
              <button id="cancelBtn" class="menu-btn red" style="--c1:#ff6b6b;--c2:#ea4335;--outer:#3b0c0c;">Cancelar</button>
            </div>
            <span class="sr-only" id="liveStatus"></span>
          </div>`;
        document.body.appendChild(loader);

        const $ = s => document.querySelector(s);
        const stageEl = () => $('#loaderStage');
        const hintEl  = () => $('#loaderHint');
        const errEl   = () => $('#loaderErr');
        const showLoader = (stage, hint="")=>{
          loader.classList.add('show');
          stageEl().textContent = stage || 'Cargando‚Ä¶';
          hintEl().textContent  = hint || 'No cierres esta ventana.';
          errEl().style.display = 'none'; errEl().textContent = '';
        };
        const showError = (msg)=>{
          errEl().textContent = msg || 'Ocurri√≥ un error.';
          errEl().style.display = 'block';
          $('#retryBtn').style.display = 'inline-block';
        };
        const hideLoader = ()=> loader.classList.remove('show');

        let cancelled = false;
        $('#cancelBtn').addEventListener('click', ()=>{ cancelled = true; hideLoader(); });
        $('#retryBtn').addEventListener('click', ()=>{ if(!cancelled) startCreateFlow().catch(()=>{}); });

        /* ---------- Utils ---------- */
        async function ensureAuth(){
          await setPersistence(auth, browserLocalPersistence);
          const user = await new Promise(res=>{
            const off = onAuthStateChanged(auth, u=>{ off(); res(u); });
          });
          return user || (await signInAnonymously(auth)).user;
        }
        function genCode(len=6){
          const A="ABCDEFGHJKLMNPQRSTUVWXYZ23456789"; let s="";
          for(let i=0;i<len;i++) s+=A[Math.floor(Math.random()*A.length)];
          return s;
        }
        async function createUniqueRoomCode(tries=12){
          for(let i=0;i<tries;i++){
            const c = genCode(6);
            const ref = doc(db,"rooms",c);
            if(!(await getDoc(ref)).exists()) return c;
          }
          return genCode(8);
        }
        async function ensureProfile(){ const {name, avatar} = await window.PlayerProfile.ensure(); return {name, avatar}; }

        /* ---------- Navegaci√≥n ---------- */
        const linkCrear    = document.getElementById("link-crear");
        const linkIngresar = document.getElementById("link-ingresar");
        const btnAzar      = document.getElementById("btn-azar");

        linkCrear?.addEventListener("click", async (e)=>{
          e.preventDefault(); cancelled = false; await startCreateFlow().catch(()=>{});
        });

        linkIngresar?.addEventListener("click", async (e)=>{
          e.preventDefault();
          const {name, avatar} = await ensureProfile();
          const sep = "ingresar.html".includes("?") ? "&" : "?";
          location.href = `ingresar.html${sep}name=${encodeURIComponent(name)}&avatar=${encodeURIComponent(avatar)}`.replace(/\s/g,"%20");
        });

        btnAzar?.addEventListener("click", async ()=>{
          try{
            const {name, avatar} = await ensureProfile();
            const snap = await getDocs(collection(db, "rooms"));
            if (snap.empty) { alert("No hay salas disponibles todav√≠a."); return; }
            const rooms = snap.docs.map(d => d.id);
            const code = rooms[Math.floor(Math.random() * rooms.length)];
            location.href = `crear.html?code=${code}&name=${encodeURIComponent(name)}&avatar=${encodeURIComponent(avatar)}`;
          }catch(err){
            console.error(err);
            alert("No pude listar salas. Prob√° refrescar o crear una sala.");
          }
        });

        /* ---------- Crear sala con overlay ---------- */
        async function startCreateFlow(){
          try{
            showLoader("Preparando cuenta‚Ä¶");
            const {name, avatar} = await ensureProfile();
            const user = await ensureAuth();
            if(cancelled) return;

            showLoader("Generando c√≥digo‚Ä¶");
            const code = await createUniqueRoomCode();
            if(cancelled) return;

            showLoader("Inicializando sala‚Ä¶");
            const roomRef   = doc(db,"rooms",code);
            const playerRef = doc(db,"rooms",code,"players",user.uid);

            const batch = writeBatch(db);
            batch.set(roomRef,{
              hostUid: user.uid,
              status: "lobby",
              isPublic: true,                 // <- aparece en la lista p√∫blica
              createdAt: serverTimestamp(),
              settings: { maxPlayers: 8, impostors: 1, tema: "Clubes", timeSec: 60 }
            },{merge:true});
            batch.set(playerRef,{
              uid: user.uid, name, avatarKey: avatar || null, slot: 1, online: true
            },{merge:true});
            await batch.commit();
            if(cancelled) return;

            localStorage.setItem("lastRoomCode", code);
            showLoader("Todo listo. Entrando‚Ä¶");
            setTimeout(()=>{
              if(!cancelled){
                location.href = `crear.html?code=${code}&name=${encodeURIComponent(name)}&avatar=${encodeURIComponent(avatar)}`;
              }
            }, 300);
          }catch(err){
            console.error(err);
            showError(`No pude crear la sala. ${err?.message ? "(" + err.message + ")" : ""}`);
          }
        }

        /* ---------- Salas p√∫blicas (lista en vivo) ---------- */
        const listEl = document.getElementById("publicRoomsList");

        function renderPublicRooms(rooms){
          if (!rooms.length){
            listEl.innerHTML = `<div style="opacity:.8;padding:6px 0;">No hay salas p√∫blicas disponibles</div>`;
            return;
          }
          listEl.innerHTML = rooms.map(r => `
            <div class="room-item">
              <div>
                <div style="font-weight:700;">Sala <span style="color:#38bdf8">${r.id}</span></div>
                <small style="opacity:.85;">Tema: ${r.tema} ¬∑ Jugadores: ${r.players || 0}/${r.max}</small>
              </div>
              <button class="menu-btn join-btn" data-join="${r.id}">Unirse</button>
            </div>
          `).join("");

          listEl.querySelectorAll("[data-join]").forEach(btn=>{
            btn.onclick = ()=> joinPublicRoom(btn.dataset.join);
          });
        }

        async function joinPublicRoom(code){
          try{
            const {name, avatar} = await ensureProfile();
            const user = await ensureAuth();

            const roomRef = doc(db,"rooms",code);
            const roomSnap = await getDoc(roomRef);
            if(!roomSnap.exists()){ alert("La sala ya no existe."); return; }

            const pRef = doc(db,"rooms",code,"players",user.uid);
            await setDoc(pRef,{
              uid:user.uid, name, avatarKey:avatar || null, online:true, slot:Date.now()
            },{merge:true});

            location.href = `crear.html?code=${code}&name=${encodeURIComponent(name)}&avatar=${encodeURIComponent(avatar)}`;
          }catch(e){
            console.error(e);
            alert("No se pudo entrar a la sala.");
          }
        }

        function subscribePublicRooms(){
          const qRooms = query(
            collection(db,"rooms"),
            where("isPublic","==",true),
            where("status","==","lobby"),
            orderBy("createdAt","desc"),
            limit(30)
          );

          onSnapshot(qRooms, async snap=>{
            // Nota: contamos jugadores por subcolecci√≥n
            const rooms = await Promise.all(snap.docs.map(async d=>{
              const data = d.data();
              const playersSnap = await getDocs(collection(db,"rooms",d.id,"players"));
              return {
                id: d.id,
                tema: data.settings?.tema || "‚Äî",
                max: data.settings?.maxPlayers || 8,
                players: playersSnap.size
              };
            }));
            renderPublicRooms(rooms);
          });
        }

        // Arrancar
        subscribePublicRooms();

      } catch (err) {
        console.error("Error inicializando Firebase:", err);
      }
    })();
  </script>

  <!-- ===== Modal nombre + avatar ===== -->
  <div id="name-modal" class="backdrop" aria-hidden="true">
    <div class="name-card" role="dialog" aria-modal="true" aria-labelledby="name-title">
      <h3 id="name-title">Eleg√≠ tu nombre</h3>
      <p>Este ser√° el nombre y avatar que ver√°n los dem√°s jugadores.</p>
      <div class="name-row">
        <input id="displayName" class="name-input" type="text" maxlength="16" placeholder="Ej: Nico, Lio üêê" />
        <button id="saveName" class="name-btn">Guardar</button>
      </div>
      <div id="nameError" class="name-error"></div>
      <div class="avatar-grid" id="avatarGrid"></div>
      <div class="avatar-hint">Eleg√≠ tu avatar</div>
    </div>
  </div>
<!-- Modal: salas p√∫blicas -->
<div id="rooms-modal" class="rz-backdrop" aria-hidden="true">
  <div class="rz-card" role="dialog" aria-modal="true" aria-labelledby="rz-title">
    <div style="display:flex;justify-content:space-between;align-items:center;gap:10px">
      <h3 id="rz-title" style="margin:0;font-family:'Bebas Neue',sans-serif;font-size:28px">Salas disponibles</h3>
      <button id="rz-close" class="rz-btn ghost">Cerrar</button>
    </div>

    <div id="rz-tools" style="display:flex;gap:8px;margin:10px 0 12px">
      <input id="rz-search" class="rz-input" placeholder="Buscar por c√≥digo‚Ä¶ (opcional)">
      <button id="rz-refresh" class="rz-btn">Actualizar</button>
    </div>

    <div id="rz-list" class="rz-list">Cargando‚Ä¶</div>

    <div style="display:flex;justify-content:flex-end;gap:8px;margin-top:12px">
      <button id="rz-random" class="rz-btn success">Unirme a una al azar</button>
    </div>
  </div>
</div>

</body>
</html>
